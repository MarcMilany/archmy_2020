Сокращение спама в журналах

После установки приложение будет сразу запущено. Так же автоматически создается пользователь debian-transmission (или подобный в зависимости от версии), данный пользователь управляет всеми процессами transmission, поэтому все пользователи использующие transmission должны быть включены в его группу.

Для дальнейшей настройки останавливаем Transmission-daemon

# остановить сервис
sudo systemctl stop transmission-daemon.service
# проверить состояние
sudo systemctl status transmission-daemon.service
Расположение конфигурационных файлов transmisson-daemon:

файл инициализирующий старт демона:

/etc/init.d/transmission-daemon

Файл конфигурации:

/etc/default/transmission-daemon

Файл global settings:

/etc/transmission-daemon/settings.json

Файл local settings:

~/.config/transmission-daemon/settings.json

2. Создание пользователя для запуска Transmision
В нашем случае для управления transmission-daemon мы создадим отдельного пользователя от имени которого и будет работать этот сервис. 

sudo adduser server
# во время установки автоматически создается пользователь debian-transmission в # его группу надо добавить нового пользователя
sudo usermod -aG debian-transmission server


Запуск transmission-daemon может привести к появлению большого количества нежелательных записей в журнале. Вывод можно отфильтровать, запустив его с помощью небольшого скрипта-обертки. Следующий пример также предоставляет некоторые уведомления:

transwrap.sh
#!/bin/zsh
killall transmission-daemon 2> /dev/null
transmission-daemon --foreground --log-info 2>&1 | while read line; do
	echo $line |
		grep -v "announcer.c:\|platform.c:\|announce done (tr-dht.c:" |
		grep -v "Saved.*variant.c:" |
		while read line; do
			echo $line | grep -q "Queued for verification (verify.c:" &&
				notify-send --app-name="Transmission Started" "${line#* * }"
			echo $line | grep -q "changed from .Incomplete. to .Complete." &&
				notify-send --app-name="Transmission Complete" "${line#* * }"
			echo $line | systemd-cat --identifier="TransWrap" --priority=5
		done 2>&1 > /dev/null
	done&disown



Запускать только при подключении к сети
Netctl
Может быть желательно запустить передачу только в определенных сетях. Следующий скрипт проверяет, что соединение находится в списке авторизованных сетей, а затем переходит к запуску transmission-daemon.

/etc/netctl/hooks/90-transmission.sh
#!/bin/bash

# The SSIDs for which we enable this.
declare -A ssids=(
    ["network_1"]=y
    ["network_2"]=y
)

if [[ ${ssids[$SSID]} ]]; then
    case $ACTION in
        CONNECT|REESTABLISHED)
            # Need to wait, otherwise doesn't seem to bind to 9091.
            sleep 30
            systemctl start transmission
            ;;
        *)
            systemctl stop transmission
            ;;
    esac
fi


Выбор пользователя
Выберите, как вы хотите бежать transmission:

Как отдельный пользователь transmissionпо умолчанию (рекомендуется для повышения безопасности).
По умолчанию transmission создает пользователя и группу transmissionс домашними файлами в /var/lib/transmission/, и запускается от имени этого "пользователя". Это мера предосторожности, поэтому transmission и его загрузки не имеют доступа к файлам за пределами /var/lib/transmission/. Настройка, эксплуатация и доступ к загрузкам должны выполняться с привилегиями "root" (например, с помощью sudo ).

Под своим пользователем. Чтобы настроить это, переопределите предоставленный файл службы и укажите свое имя пользователя:

/etc/systemd/system/transmission.service.d/username.conf
[Service]
User=your_username

Настройка демона
Создайте начальный файл конфигурации, запустив демон .

Если Transmission запущена под именем пользователя transmission, файл конфигурации будет расположен по адресу /var/lib/transmission/.config/transmission-daemon/settings.json.
Если вы запускаете Transmission под своим именем пользователя, файл конфигурации будет расположен по адресу ~/.config/transmission-daemon/settings.json.
Демон можно настроить с помощью клиента Transmission или с помощью встроенного веб-интерфейса, доступного по адресу http://localhost:9091 в поддерживаемом браузере.

Руководство по параметрам конфигурации можно найти на веб-сайте Transmission: https://github.com/transmission/transmission/blob/main/docs/Editing-Configuration-Files.md

Примечание:
Если вы хотите редактировать конфигурацию вручную с помощью текстового редактора, сначала остановите демон ; в противном случае он перезапишет свой файл конфигурации при закрытии.
В качестве альтернативы можно дать команду демону перезагрузить свою конфигурацию с помощью SIGHUP, запустив kill -s SIGHUP $(pidof transmission-daemon).
Рекомендация для тех, кто работает под именем пользователя, transmission— создать общий каталог загрузки с правильными разрешениями, чтобы разрешить доступ как transmissionпользователю, так и системным пользователям, а затем обновить файл конфигурации соответствующим образом. Например:

# mkdir /mnt/data/torrents
# chown -R facade:transmission /mnt/data/torrents
# chmod -R 775 /mnt/data/torrents

Теперь /mnt/data/torrentsбудет доступен для пользователя системы facadeи для transmissionгруппы, к которой transmissionпринадлежит пользователь. Делать целевой каталог доступным для чтения/записи всем крайне не рекомендуется (т. е. не делайте chmod каталога на 777 ). Вместо этого предоставьте отдельным пользователям/группам соответствующие разрешения на соответствующие каталоги.

Примечание: Если /mnt/data/torrentsнаходится на съемном устройстве, например, с /etc/fstabзаписью с опцией nofail, Transmission будет жаловаться, что не может найти ваши файлы. Чтобы исправить это, вы можете добавить RequiresMountsFor=/mnt/data/torrentsв /etc/systemd/system/transmission.service.d/transmission.confраздел [Unit].
Альтернативой является добавление пользователя в transmissionгруппу ( #usermod -a -G transmission yourusername), а затем изменение разрешений для каталогов /var/lib/transmissionи /var/lib/transmission/Downloads, чтобы разрешить rwxдоступ членам группы transmission.

Белый список хостов
Если вы планируете получить доступ к демону Transmission по сети, используя имя хоста сервера, вам необходимо добавить это имя хоста rpc-host-whitelistв settings.json. В противном случае при доступе к серверу вы получите ошибку «421 Misdirected Request».

Если вы подключаетесь к демону, используя IP-адрес сервера, то это не требуется.

Смотреть реж.
Если вы хотите автоматически добавлять файлы .torrent из папки , но обнаружили, что параметры watch-dirи , watch-dir-enabledзаданные в файле конфигурации, не работают, вы можете запустить демон передачи с флагом -c /path/to/watch/dir.

Если вы используете systemd, отредактируйте transmission.serviceмодуль, как описано в разделе systemd#Редактирование предоставленных модулей .

Включить IPv6
По умолчанию демон прослушивает только соединения IPv4. Чтобы также прослушивать соединения IPv6, измените rpc-bind-addressпараметр на "::"в settings.json.

Примеры CLI
Если вы хотите удалить все завершенные торренты, вы можете использовать следующую команду, указав свое имя пользователя и пароль:
# transmission-remote -n 'username:password' -l | grep 100% | awk '{print $1}'| paste -d, -s | xargs -i transmission-remote -t {} -r

# transmission-remote -n 'имя пользователя:пароль' -l | grep 100% | awk '{print $1}'| paste -d, -s | xargs -i transmission-remote -t ??{} -r

Раздать торрент, который уже был скачан:
# transmission-remote [HOST] --torrent=example.torrent -a example.torrent --verify --download-dir=/dir/to/folder --start

# transmission-remote [ХОСТ] --torrent=example.torrent -a example.torrent --verify --download-dir=/dir/to/folder --start

Уведомление
Остановите transmission-daemon и добавьте это в .config/transmission-daemon/settings.json:

   "script-torrent-added-enabled": true,
   "script-torrent-added-filename": "path/to/transmission-handler.sh",
   "script-torrent-done-enabled": true,
   "script-torrent-done-filename": "path/to/transmission-handler.sh",

transmission-handler.sh
#!/bin/bash

percentage=$(transmission-remote -t $TR_TORRENT_ID -l | awk -v ID="$TR_TORRENT_ID" '$0 ~ ID{print $2}')

if [ $percentage != "100%" ]
then
     notify-send --app-name="Transmission Started" "Transmission: started $TR_TORRENT_NAME"
else
     notify-send --app-name="Transmission Complete" "Transmission: downloaded $TR_TORRENT_NAME"
fi
